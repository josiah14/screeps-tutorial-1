{"version":3,"sources":["game/map.js"],"names":["utils","require","driver","getDriver","C","constants","_","util","pathUtils","Heap","OpenClosed","kRouteGrid","exports","makeMap","runtimeData","register","heap","openClosed","parents","originX","originY","toX","toY","describeExits","roomName","test","roomNameToXY","x","y","gridItem","mapGrid","gridData","exits","t","TOP","getRoomNameFromXY","b","BOTTOM","l","LEFT","r","RIGHT","xyToIndex","xx","yy","ox","oy","indexToXY","index","Math","floor","heuristic","abs","findRoute","fromRoom","toRoom","opts","isObject","name","ERR_NO_PATH","fromX","fromY","clear","pow","Float64Array","Uint16Array","fromIndex","push","routeCallback","size","min","fcost","minPriority","pop","close","hcost","gcost","route","nx","ny","dir","FIND_EXIT_RIGHT","FIND_EXIT_LEFT","FIND_EXIT_BOTTOM","FIND_EXIT_TOP","exit","room","reverse","fromRoomName","graphKey","neighborIndex","undefined","isClosed","cost","Number","Infinity","isOpen","priority","update","open","findExit","isArray","length","ERR_INVALID_ARGS","isRoomProtected","deprecated","contains","accessibleRooms","isRoomAvailable","getTerrainAt","staticTerrainData","terrain","TERRAIN_MASK_WALL","TERRAIN_MASK_SWAMP","getRoomLinearDistance","roomName1","roomName2","continuous","calcRoomsDistance"],"mappings":"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","file":"../../game/map.js","sourceRoot":"/src"}