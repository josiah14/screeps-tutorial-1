{"version":3,"sources":["main.js"],"names":["q","require","_","usersQueue","roomsQueue","utils","driver","getDriver","config","lastAccessibleRoomsUpdate","loop","resetInterval","startLoopTime","process","hrtime","Date","now","stage","emit","self","setInterval","console","error","queue","resetAll","mainLoopResetInterval","notifyTickStarted","then","getAllUsers","users","addMulti","map","user","_id","toString","whenAllDone","getAllRooms","rooms","room","commitDbBulk","incrementGameTime","log","gameTime","updateAccessibleRoomsList","notifyRoomsDone","mainLoopCustomStage","catch","isObject","stack","finally","clearInterval","usedTime","setTimeout","Math","max","mainLoopMinDuration","connect","all","create","data","rejections","getUnhandledReasons","forEach","i","resetUnhandledRejections"],"mappings":"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","file":"../main.js","sourceRoot":"/src"}